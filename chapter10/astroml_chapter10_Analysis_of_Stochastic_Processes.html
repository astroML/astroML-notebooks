
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analysis of Stochastic Processes &#8212; AstroML Notebooks</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Temporally localized signals" href="astroml_chapter10_Temporally_Localized_Signals.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/astroml_logo.gif" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">AstroML Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter5/README.html">
   Chapter 5: Bayesian Statistical Inference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Gaussian_Distribution.html">
     Parameter Estimation for a Gaussian Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Binomial_Distribution.html">
     Parameter Estimation for a Binomial Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Cauchy_Distribution.html">
     Parameter estimation for the Cauchy (Lorentzian) distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter5/astroml_chapter5_Approximate_Bayesian_Computation.html">
     Approximate Bayesian Computation Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter5/astroml_chapter5_Hierarchical_Bayes.html">
     Hierarchical Bayes Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter6/README.html">
   Chapter 6: Searching for Structure in Point Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter6/astroml_chapter6_Density_Estimation_for_SDSS_Great_Wall.html">
     Density Estimation for SDSS “Great Wall”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter6/astroml_chapter6_Searching_for_Structure_in_Point_Data.html">
     Searching for Structure in Point Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter6/astroml_chapter6_Gaussian_Mixture_Models.html">
     Gaussian Mixture Models Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter6/astroml_chapter6_Extreme_Deconvolution.html">
     Extreme Deconvolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter7/README.html">
   Chapter 7: Dimensionality and its Reduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter7/astroml_chapter7_Dimensionality_Reduction.html">
     Dimensionality reduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter8/README.html">
   Chapter 8: Regression and Model Fitting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter8/astroml_chapter8_Regression.html">
     Measurement Errors in Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter8/astroml_chapter8_Regression_with_Errors_on_Dependent_and_Independent_Variables.html">
     Measurement errors in both dependent and independent variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter9/README.html">
   Chapter 9: Classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter9/astroml_chapter9_Classification.html">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter9/astroml_chapter9_Deep_Learning_Classifying_Astronomical_Images.html">
     Deep Learning: Classifying Astronomical Images
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Chapter 10: Time Series Analysis
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="astroml_chapter10_Modeling_Toolkit_for_Time_Series_Analysis.html">
     Modeling Toolkit For Time Series Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="astroml_chapter10_Wavelets.html">
     Wavelets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="astroml_chapter10_Digital_Filtering.html">
     Digital Filtering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="astroml_chapter10_Temporally_Localized_Signals.html">
     Temporally localized signals
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Analysis of Stochastic Processes
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/chapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.md.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/astroML/astroML-notebooks"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/astroML/astroML-notebooks/issues/new?title=Issue%20on%20page%20%2Fchapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/astroML/astroML-notebooks/edit/main/chapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/astroML/astroML-notebooks/main?urlpath=tree/chapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-functions">
   Import functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-autocorrelation-and-structure-functions">
   The autocorrelation and structure functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examples-of-stochastic-processes-1-f-and-1-f-2-processes">
     Examples of stochastic processes:
     <span class="math notranslate nohighlight">
      \(1/f\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(1/f^2\)
     </span>
     processes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-data-for-plotting">
       1. Generate data for plotting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-psd-and-compare-results">
       2. Calculate PSD and compare results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#autocorrelation-and-structure-function-for-evenly-and-unevenly-sampled-data">
   Autocorrelation and structure function for evenly and unevenly sampled data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evenly-sampled-data">
     Evenly sampled data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unevenly-sampled-data">
     Unevenly sampled data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#edelson-and-krolik-s-dcf-method-and-the-scargle-method-demonstration">
     Edelson and Krolik’s DCF method and the Scargle method Demonstration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-time-series-data">
       1. Generate time-series data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-acf-via-scargle-method">
       2. Compute ACF via Scargle method
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-acf-via-e-k-method">
       3. Compute ACF via E-K method
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compare-results">
       4. Compare results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#autoregressive-models">
   Autoregressive models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#damped-random-walk-model">
   Damped random walk model
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="analysis-of-stochastic-processes">
<h1>Analysis of Stochastic Processes<a class="headerlink" href="#analysis-of-stochastic-processes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Stochastic variability includes behavior that is not predictable forever as in the periodic case, but
unlike temporally localized events, variability is always there. Typically, the underlying physics is
so complex that we cannot deterministically predict future values.<br />
Despite their seemingly irregular behavior, stochastic processes can be quantified. In this notebook, we will mainly discuss <strong>autocorrelation</strong>, <strong>autoregressive</strong> and <strong>damped random walk</strong> models in analyzing stochastic processes.</p>
</div>
<div class="section" id="import-functions">
<h2>Import functions<a class="headerlink" href="#import-functions" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, we mainly use functions from <em>astroML.time_series</em> and from <em>astroML.fourier</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">astroML.time_series</span> <span class="kn">import</span> <span class="n">generate_power_law</span>
<span class="kn">from</span> <span class="nn">astroML.fourier</span> <span class="kn">import</span> <span class="n">PSD_continuous</span>

<span class="kn">from</span> <span class="nn">astroML.time_series</span> <span class="kn">import</span> <span class="n">lomb_scargle</span><span class="p">,</span> <span class="n">generate_damped_RW</span>
<span class="kn">from</span> <span class="nn">astroML.time_series</span> <span class="kn">import</span> <span class="n">ACF_scargle</span><span class="p">,</span> <span class="n">ACF_EK</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astroML.plotting</span> <span class="kn">import</span> <span class="n">setup_text_plots</span>
<span class="n">setup_text_plots</span><span class="p">(</span><span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-autocorrelation-and-structure-functions">
<h2>The autocorrelation and structure functions<a class="headerlink" href="#the-autocorrelation-and-structure-functions" title="Permalink to this headline">¶</a></h2>
<p>One of the main statistical tools for the analysis of stochastic variability is the <strong>autocorrelation
function</strong>. It represents a specialized case of the correlation function of two functions, f(t) and g(t),
scaled by their standard deviations, and defined at time lag <span class="math notranslate nohighlight">\(\Delta t\)</span> as</p>
<div class="math notranslate nohighlight">
\[CF(\Delta t) = \frac{lim_{T \rightarrow \infty} \frac{1}{T} \int_{(T)}f(t)g(t+ \Delta t)dt}{\sigma_f \sigma_g}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_f\)</span> and <span class="math notranslate nohighlight">\(\sigma_g\)</span> are standard deviations of f(t) and g(t), respectively. With this normalization, the
correlation function is unity for <span class="math notranslate nohighlight">\(\Delta t\)</span> = 0 (without normalization by standard deviation, the above
expression is equal to the covariance function). It is assumed that both f and g are statistically
weakly stationary functions, which means that their mean and autocorrelation function (see below)
do not depend on time. The correlation function yields information about the time delay
between two processes. If one time series is produced from another one by simply shifting the time
axis by tlag, their correlation function has a peak at <span class="math notranslate nohighlight">\(\Delta t = t_{lag}\)</span>.</p>
<p>With <span class="math notranslate nohighlight">\(f(t) = g(t) = y(t)\)</span>, the autocorrelation of y(t) defined at time lag <span class="math notranslate nohighlight">\(\Delta t\)</span> is</p>
<div class="math notranslate nohighlight">
\[ACF(\Delta t) = \frac{lim_{T \rightarrow \infty} \frac{1}{T} \int_{(T)}y(t)y(t+ \Delta t)dt}{\sigma_y^2}\]</div>
<p>The autocorrelation function yields information about the variable timescales present in a process.
When y values are uncorrelated (e.g., due to white noise without any signal), <span class="math notranslate nohighlight">\(ACF(\Delta t) = 0\)</span>, except for <span class="math notranslate nohighlight">\(ACF(0) =1\)</span>. For processes that “retain memory” of previous states only for some characteristic
time <span class="math notranslate nohighlight">\(\tau\)</span>, the autocorrelation function vanishes for <span class="math notranslate nohighlight">\(\Delta t \gg \tau\)</span>.</p>
<p>The autocorrelation function and the PSD of function y(t) (i.e. <span class="math notranslate nohighlight">\(PSD(f) \equiv |H(f)|^2 + |H(-f)|^2\)</span>) are Fourier pairs; this
fact is known as the Wiener-Khinchin theorem and applies to stationary random processes. The
former represents an analysis method in the time domain, and the latter in the frequency domain.</p>
<p>The <strong>structure function</strong> is another quantity closely related to the autocorrelation function,</p>
<div class="math notranslate nohighlight">
\[SF(\Delta t) = SF_\infty [1-ACF(\Delta t)]^{\frac{1}{2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(SF_\infty\)</span> is the standard deviation of the time series evaluated over an infinitely large time
interval (or at least much longer than any characteristic timescale <span class="math notranslate nohighlight">\(\tau\)</span>).</p>
<div class="section" id="examples-of-stochastic-processes-1-f-and-1-f-2-processes">
<h3>Examples of stochastic processes: <span class="math notranslate nohighlight">\(1/f\)</span> and <span class="math notranslate nohighlight">\(1/f^2\)</span> processes<a class="headerlink" href="#examples-of-stochastic-processes-1-f-and-1-f-2-processes" title="Permalink to this headline">¶</a></h3>
<p>For a given autocorrelation function or PSD, the corresponding time series can be generated using
the algorithm described in <a class="reference external" href="http://adsabs.harvard.edu/full/1995A%26A...300..707T">On generating power law noise</a>. Essentially, the amplitude of the Fourier transform is given by the
PSD, and phases are assigned randomly; the inverse Fourier transform then generates time series.<br />
The connection between the PSD and the appearance of time series of two power-law PSDs: <span class="math notranslate nohighlight">\(1/f\)</span> and <span class="math notranslate nohighlight">\(1/f^2\)</span> is illustrated in figure below.</p>
<div class="section" id="generate-data-for-plotting">
<h4>1. Generate data for plotting<a class="headerlink" href="#generate-data-for-plotting" title="Permalink to this headline">¶</a></h4>
<p>Let us use 1024 data points, and let <span class="math notranslate nohighlight">\(\Delta t = 0.01\)</span> in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">factor</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-psd-and-compare-results">
<h4>2. Calculate PSD and compare results<a class="headerlink" href="#calculate-psd-and-compare-results" title="Permalink to this headline">¶</a></h4>
<p>We use <em>generate_power_law</em> in <em>astroML_time_series</em> package to apply the algorithm <a class="reference external" href="http://adsabs.harvard.edu/full/1995A%26A...300..707T">On generating power law noise</a> on our generated data.<br />
In the plot below shows examples of stochastic time series generated from power-law PSDs.</p>
<ul class="simple">
<li><p>Plots of generated data (top panels) and the corresponding PSD (bottom panels) are shown.</p></li>
<li><p>Results from <span class="math notranslate nohighlight">\(1/f\)</span> power-law (left panels) and from <span class="math notranslate nohighlight">\(1/f^2\)</span> (right panel) are shown.</p></li>
<li><p>Dashed lines indicate input PSD, and solid lines are determined from time series shown in the top panels.</p></li>
</ul>
<p>The PSD normalization is such that both cases have similar
power at low frequencies. For this reason, the overall amplitudes (more precisely, the variance) of
the two time series are similar. The power at high frequencies is much larger for the <span class="math notranslate nohighlight">\(1/f\)</span> case, and
this is why the corresponding time series has the appearance of noisy data.<br />
The structure function for the <span class="math notranslate nohighlight">\(1/f\)</span> process is constant, and proportional to <span class="math notranslate nohighlight">\(t^{1/2}\)</span> for
the <span class="math notranslate nohighlight">\(1/f^2\)</span> process (remember that we defined structure function with a square root).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]):</span>
    <span class="c1"># Generate the light curve and compute the PSD</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">generate_power_law</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">PSD</span> <span class="o">=</span> <span class="n">PSD_continuous</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># First axes: plot the time series</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$P(f) \propto f^{-</span><span class="si">%i</span><span class="s2">}$&quot;</span> <span class="o">%</span> <span class="n">beta</span><span class="p">,</span>
             <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.24</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>

    <span class="c1"># Second axes: plot the PSD</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">(</span><span class="n">factor</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">**</span> <span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1E-1</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1E-6</span><span class="p">,</span> <span class="mf">1E1</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f$&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;${\rm counts}$&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$PSD(f)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="autocorrelation-and-structure-function-for-evenly-and-unevenly-sampled-data">
<h2>Autocorrelation and structure function for evenly and unevenly sampled data<a class="headerlink" href="#autocorrelation-and-structure-function-for-evenly-and-unevenly-sampled-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="evenly-sampled-data">
<h3>Evenly sampled data<a class="headerlink" href="#evenly-sampled-data" title="Permalink to this headline">¶</a></h3>
<p>In the case of <strong>evenly sampled data</strong>, with <span class="math notranslate nohighlight">\(t_i = (i-1)\Delta t\)</span>, the autocorrelation function of a discretely sampled <span class="math notranslate nohighlight">\(y(t)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[ACF(j) = \frac{\sum^{N-j}_{i=1} [(y_i-\bar{y})(y_{i+j}-\bar{y})]}{\sum^{N}_{i=1}(y_i-\bar{y})^2}\]</div>
<p>The uncertainty of the mean is</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{N}}[1+2 \sum^N_{j=1}(1-\frac{j}{N})ACF(j)]^{1/2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the homoscedastic measurement error.<br />
When a time series has a nonvanishing ACF, the uncertainty of its mean is larger than for an uncorrelated data set, where <span class="math notranslate nohighlight">\(\sigma_{\bar{x}} = \frac{s}{\sqrt{N}}\)</span>.<br />
When data are unevenly sampled, the ACF cannot be computed using equations above.</p>
</div>
<div class="section" id="unevenly-sampled-data">
<h3>Unevenly sampled data<a class="headerlink" href="#unevenly-sampled-data" title="Permalink to this headline">¶</a></h3>
<p>For the case of <strong>unevenly sampled data</strong>, Edelson and Krolik proposed the <strong>“discrete correlation function” (DCF)</strong> in an astronomical context (called the “slot autocorrelation function” in physics). See <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1988ApJ...333..646E/abstract">The Discrete Correlation Function</a>.<br />
For discrete unevenly sampled data with homoscedastic errors, they defined a quantity</p>
<div class="math notranslate nohighlight">
\[UDCF_{ij} = \frac{(y_i-\bar{y})(g_j-\bar{g})}{[(\sigma_y^2-e_y^2)(\sigma_g^2-e_g^2)^{1/2}]}\]</div>
<p>where <span class="math notranslate nohighlight">\(e_y\)</span> and <span class="math notranslate nohighlight">\(e_g\)</span> are homoscedastic measurement errors for time series y and g. The associated time
lag is <span class="math notranslate nohighlight">\(\Delta t_{ij} = ti - tj\)</span>. The discrete correlation function at time lag <span class="math notranslate nohighlight">\(\Delta t\)</span> is then computed by binning
and averaging <span class="math notranslate nohighlight">\(UDCF_{ij}\)</span> over M pairs of points for which <span class="math notranslate nohighlight">\(\Delta t-\delta t=2 \leq \delta t_{ij} \leq \Delta t+\delta t/2\)</span>, where <span class="math notranslate nohighlight">\(\delta t\)</span> is
the bin size. The bin size is a trade-of between accuracy of <span class="math notranslate nohighlight">\(DCF(\Delta t)\)</span> and its resolution. Edelson and Krolik showed that even uncorrelated time series will produce values of the cross-correlation <span class="math notranslate nohighlight">\(DCF(\Delta t) \sim \pm 1/ \sqrt{M}\)</span>.</p>
<p>Scargle has developed different techniques to evaluate the discrete Fourier transform, correlation
function and autocorrelation function of unevenly sampled time series (see <a class="reference external" href="https://www.osti.gov/biblio/5344858-studies-astronomical-time-series-analysis-iii-fourier-transforms-autocorrelation-functions-cross-correlation-functions-unevenly-spaced-data">Studies in astronomical time series analysis. III.</a>).<br />
Given an unevenly sampled time series, y(t), the essential steps of Scargle’s
procedure are as follows:</p>
<ol class="simple">
<li><p>Compute the generalized Lomb-Scargle periodogram for <span class="math notranslate nohighlight">\(y(t_i), i = 1,..., N\)</span>, namely <span class="math notranslate nohighlight">\(P_{LS}(\omega)\)</span>.</p></li>
<li><p>Compute the sampling window function using the generalized Lomb-Scargle periodogram using <span class="math notranslate nohighlight">\(z(t_i) = 1, i = 1,..., N\)</span>, namely <span class="math notranslate nohighlight">\(P_{LS}^W(\omega)\)</span>.</p></li>
<li><p>Compute inverse Fourier transforms for <span class="math notranslate nohighlight">\(P_{LS}(\omega)\)</span> and <span class="math notranslate nohighlight">\(P^W_{LS}(\omega)\)</span>, namely <span class="math notranslate nohighlight">\(\rho(t)\)</span> and <span class="math notranslate nohighlight">\(\rho^W(t)\)</span>, respectively.</p></li>
<li><p>The autocorrelation function at lag t is <span class="math notranslate nohighlight">\(ACF(t) = \rho(t)/ \rho^W(t)\)</span>.</p></li>
</ol>
</div>
<div class="section" id="edelson-and-krolik-s-dcf-method-and-the-scargle-method-demonstration">
<h3>Edelson and Krolik’s DCF method and the Scargle method Demonstration<a class="headerlink" href="#edelson-and-krolik-s-dcf-method-and-the-scargle-method-demonstration" title="Permalink to this headline">¶</a></h3>
<p>We will see an example of the use of Edelson and Krolik’s DCF method and the Scargle method.</p>
<div class="section" id="generate-time-series-data">
<h4>1. Generate time-series data<a class="headerlink" href="#generate-time-series-data" title="Permalink to this headline">¶</a></h4>
<p>We use do 1000 days worth of magnitudes for this sample data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1E3</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">tau_obs</span> <span class="o">=</span> <span class="n">tau</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">generate_damped_RW</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">xmean</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># randomly sample 100 of these</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
<span class="n">ind</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

<span class="c1"># add errors</span>
<span class="n">dy</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compute-acf-via-scargle-method">
<h4>2. Compute ACF via Scargle method<a class="headerlink" href="#compute-acf-via-scargle-method" title="Permalink to this headline">¶</a></h4>
<p>We calculate the ACF following Scargle method process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C_S</span><span class="p">,</span> <span class="n">t_S</span> <span class="o">=</span> <span class="n">ACF_scargle</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
                       <span class="n">n_omega</span><span class="o">=</span><span class="mf">2.</span> <span class="o">**</span> <span class="mi">12</span><span class="p">,</span> <span class="n">omega_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>

<span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_S</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t_S</span> <span class="o">&lt;=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">t_S</span> <span class="o">=</span> <span class="n">t_S</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">C_S</span> <span class="o">=</span> <span class="n">C_S</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compute-acf-via-e-k-method">
<h4>3. Compute ACF via E-K method<a class="headerlink" href="#compute-acf-via-e-k-method" title="Permalink to this headline">¶</a></h4>
<p>We calculate ACF using Edelson and Krolik’s DCF method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C_EK</span><span class="p">,</span> <span class="n">C_EK_err</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">ACF_EK</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">51</span><span class="p">))</span>
<span class="n">t_EK</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compare-results">
<h4>4. Compare results<a class="headerlink" href="#compare-results" title="Permalink to this headline">¶</a></h4>
<p>Example of the autocorrelation function for a stochastic process is shown below.</p>
<ul class="simple">
<li><p>The top panel shows a simulated light curve generated using a damped random walk model.</p></li>
<li><p>The bottom panel shows the corresponding autocorrelation function computed using Edelson and Krolik’s DCF method and the Scargle method.</p></li>
<li><p>The solid line shows the input autocorrelation function used to generate the light curve.</p></li>
</ul>
<p>The two methods produce similar results. Errors are easier to compute for the DCF method and this advantage
is crucial when fitting models to the autocorrelation function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># plot the input data</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (days)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;observed flux&#39;</span><span class="p">)</span>

<span class="c1"># plot the ACF</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_S</span><span class="p">,</span> <span class="n">C_S</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Scargle&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t_EK</span><span class="p">,</span> <span class="n">C_EK</span><span class="p">,</span> <span class="n">C_EK_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Edelson-Krolik&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_S</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">t_S</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau_obs</span><span class="p">),</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_S</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">t_S</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t (days)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;ACF(t)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="autoregressive-models">
<h2>Autoregressive models<a class="headerlink" href="#autoregressive-models" title="Permalink to this headline">¶</a></h2>
<p>Autocorrelated time series can be analyzed and characterized using stochastic <strong>“autoregressive models.”</strong>
Autoregressive models provide a good general description of processes that “retain memory”
of previous states (but are not periodic). An example of such a model is the <strong>random walk</strong>, where
each new value is obtained by adding noise to the preceding value:</p>
<div class="math notranslate nohighlight">
\[y_i = y_{i-1} + e_i\]</div>
<p>When <span class="math notranslate nohighlight">\(y_{i-1}\)</span> is multiplied by a constant factor greater than 1, the model is known as a geometric
random walk model (used extensively to model stock market data). The noise need not be Gaussian.</p>
<p>The random walk can be generalized to the <strong>linear autoregressive (AR) model</strong> with dependencies
on k past values (i.e., not just one as in the case of random walk). An autoregressive process of
order k, AR(k), for a discrete data set is defined by</p>
<div class="math notranslate nohighlight">
\[y_i = \sum^{k}_{j=1} a_j y_{i-j} + e_i\]</div>
<p>That is, the latest value of y is expressed as a linear combination of the k previous values of y, with
the addition of noise (for random walk, k = 1 and a1 = 1). If the data are drawn from a stationary
process, coefficients aj satisfy certain conditions. The ACF for an AR(k) process is nonzero for all
lags, but it decays quickly.</p>
<p>An autoregressive process defined by <span class="math notranslate nohighlight">\(y_i = \sum^{k}_{j=1} a_j y_{i-j} + e_i\)</span> applies only to evenly sampled time series. A
generalization is called the <strong>continuous autoregressive process, CAR(k)</strong>; see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009ApJ...698..895K/abstract">Are the Variations in Quasar Optical Flux Driven by Thermal Fluctuations</a>. The CAR(1)
process has recently received a lot of attention in the context of quasar variability.</p>
<p>In addition to autoregressive models, data can be modeled using the <strong>covariance matrix</strong> (e.g., using
Gaussian process in Gaussian process regression section). For example, for the CAR(1) process,</p>
<div class="math notranslate nohighlight">
\[S_{ij} = \sigma^2 exp(-|t_{ij} / \tau|)\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> are model parameters; <span class="math notranslate nohighlight">\(\sigma^2\)</span> controls the short timescale covariance (<span class="math notranslate nohighlight">\(t_{ij} \ll \tau\)</span>),
which decays exponentially on a timescale given by <span class="math notranslate nohighlight">\(\tau\)</span>. A number of other convenient models
and parametrizations for the covariance matrix are discussed in the context of quasar variability
in <a class="reference external" href="https://arxiv.org/abs/1202.3783">Is quasar variability a damped random walk?</a>.</p>
</div>
<div class="section" id="damped-random-walk-model">
<h2>Damped random walk model<a class="headerlink" href="#damped-random-walk-model" title="Permalink to this headline">¶</a></h2>
<p>The CAR(1) process is described by a stochastic differential equation which includes a damping
term that pushes y(t) back to its mean (see <a class="reference external" href="https://arxiv.org/abs/1202.3783">Is quasar variability a damped random walk?</a>);</p>
<p>hence, it is also known as damped random walk. In analogy with calling random walk “drunkard’s walk,” damped random walk could
be called “married drunkard’s walk” (who always comes home instead of drifting away).
Following <span class="math notranslate nohighlight">\(S_{ij} = \sigma^2 exp(-|t_{ij} / \tau|)\)</span>, the autocorrelation function for a damped random walk is</p>
<div class="math notranslate nohighlight">
\[ACF(t) = exp(-t/ \tau)\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the characteristic timescale (relaxation time, or damping timescale). Given the <span class="math notranslate nohighlight">\(ACF\)</span>,
it is easy to show that the structure function is</p>
<div class="math notranslate nohighlight">
\[SF(t) = SF_{\infty} [1-exp(-t/ \tau)]^{1/2}\]</div>
<p>where <span class="math notranslate nohighlight">\(SF_{\infty}\)</span> is the asymptotic value of the structure function equal to <span class="math notranslate nohighlight">\(\sqrt{2} \sigma\)</span>, where <span class="math notranslate nohighlight">\(\sigma\)</span> has the same definition as in <span class="math notranslate nohighlight">\(S_{ij} = \sigma^2 exp(-|t_{ij} / \tau|)\)</span>. When the structure function applies to differences of the analyzed process</p>
<div class="math notranslate nohighlight">
\[PSD(f) = \frac{\tau^2 SF^2_{\infty}}{1+(2 \pi f \tau)^2}\]</div>
<p>Therefore, the damped random walk is a <span class="math notranslate nohighlight">\(1/f^2\)</span> process at high frequencies, just as ordinary random
walk. The “damped nature” is seen as the at PSD at low frequencies (<span class="math notranslate nohighlight">\(f \ll 2\pi / \tau\)</span>). In the previous figure demonstrating E-K method and Scargle method, a light curve generated using a damped random walk is shown in the top panel.</p>
<p>For evenly sampled data, the <span class="math notranslate nohighlight">\(CAR(1)\)</span> process is equivalent to the <span class="math notranslate nohighlight">\(AR(1)\)</span> process with <span class="math notranslate nohighlight">\(a_1 =
exp(-1 / \tau)\)</span>, that is, the next value of <span class="math notranslate nohighlight">\(y\)</span> is the damping factor times the previous value plus noise.
The noise for the <span class="math notranslate nohighlight">\(AR(1)\)</span> process, <span class="math notranslate nohighlight">\(\sigma_{AR}\)</span> is related to <span class="math notranslate nohighlight">\(SF_{\infty}\)</span> via</p>
<div class="math notranslate nohighlight">
\[\sigma_{AR} = \frac{SF_{\infty}}{\sqrt{2}} [1-exp(-2 / \tau)]^{1/2}\]</div>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="astroml_chapter10_Temporally_Localized_Signals.html" title="previous page">Temporally localized signals</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By AstroML developers<br/>
        
            &copy; Copyright 2020-2021, AstroML developers.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>