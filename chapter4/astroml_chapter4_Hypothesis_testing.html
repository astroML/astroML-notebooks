

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Hypothesis Testing &#8212; AstroML Interactive Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter4/astroml_chapter4_Hypothesis_testing';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Comparison of distributions" href="astroml_chapter4_Comparison_of_distributions.html" />
    <link rel="prev" title="Confidence Estimates: The Bootstrap and The Jackknife" href="astroml_chapter4_Confidence_estimates.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/astroml_logo.gif" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/astroml_logo.gif" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/astroML/astroML-notebooks" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter1/README.html">Chapter 1: Introduction and Data Sets</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter2/README.html">Chapter 2: Fast Computation and Massive Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter3/README.html">Chapter 3: Probability and Statistical Distributions</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/astroml_chapter3_Overview_of_Probability_and_Random_Variables.html">Overview of Probability and Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/astroml_chapter3_Descriptive_Statistics.html">Descriptive Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/astroml_chapter3_Univariate_Distribution_Functions.html">Univariate Distribution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/astroml_chapter3_The_Central_Limit_Theorem.html">The Central Limit Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/astroml_chapter3_Bivariate_and_Multivariate_Distribution_Functions.html">Bivariate and multivariate distribution functions</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Chapter 4: Classical Statistical Inference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="astroml_chapter4_Maximum_Likelihood_Estimation_and_Goodness_of_fit.html">Maximum Likelihood Estimation (MLE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="astroml_chapter4_Gaussian_mixtures.html">MLE applied to Gaussian mixtures</a></li>
<li class="toctree-l2"><a class="reference internal" href="astroml_chapter4_Confidence_estimates.html">Confidence Estimates: The Bootstrap and The Jackknife</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Hypothesis Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="astroml_chapter4_Comparison_of_distributions.html">Comparison of distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter5/README.html">Chapter 5: Bayesian Statistical Inference</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Gaussian_Distribution.html">Parameter Estimation for a Gaussian Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Binomial_Distribution.html">Parameter Estimation for a Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/astroml_chapter5_Parameter_Estimation_for_Cauchy_Distribution.html">Parameter estimation for the Cauchy (Lorentzian) distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/astroml_chapter5_Approximate_Bayesian_Computation.html">Approximate Bayesian Computation Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/astroml_chapter5_Hierarchical_Bayes.html">Hierarchical Bayes Example</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter6/README.html">Chapter 6: Searching for Structure in Point Data</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/astroml_chapter6_Density_Estimation_for_SDSS_Great_Wall.html">Density Estimation for SDSS “Great Wall”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/astroml_chapter6_Searching_for_Structure_in_Point_Data.html">Searching for Structure in Point Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/astroml_chapter6_Gaussian_Mixture_Models.html">Gaussian Mixture Models Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/astroml_chapter6_Extreme_Deconvolution.html">Extreme Deconvolution</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter7/README.html">Chapter 7: Dimensionality and its Reduction</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter7/astroml_chapter7_Dimensionality_Reduction.html">Dimensionality reduction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter8/README.html">Chapter 8: Regression and Model Fitting</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/astroml_chapter8_Regression.html">Measurement Errors in Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/astroml_chapter8_Regression_with_Errors_on_Dependent_and_Independent_Variables.html">Measurement errors in both dependent and independent variables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter9/README.html">Chapter 9: Classification</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/astroml_chapter9_Classification.html">Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/astroml_chapter9_Deep_Learning_Classifying_Astronomical_Images.html">Deep Learning: Classifying Astronomical Images</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter10/README.html">Chapter 10: Time Series Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/astroml_chapter10_Modeling_Toolkit_for_Time_Series_Analysis.html">Modeling Toolkit For Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/astroml_chapter10_Wavelets.html">Wavelets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/astroml_chapter10_Digital_Filtering.html">Digital Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/astroml_chapter10_Temporally_Localized_Signals.html">Temporally localized signals</a></li>

<li class="toctree-l2"><a class="reference internal" href="../chapter10/astroml_chapter10_Analysis_of_Stochastic_Processes.html">Analysis of Stochastic Processes</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/astroML/astroML-notebooks/main?urlpath=tree/chapter4/astroml_chapter4_Hypothesis_testing.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/astroML/astroML-notebooks/blob/main/chapter4/astroml_chapter4_Hypothesis_testing.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/astroML/astroML-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/astroML/astroML-notebooks/edit/main/chapter4/astroml_chapter4_Hypothesis_testing.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/astroML/astroML-notebooks/issues/new?title=Issue%20on%20page%20%2Fchapter4/astroml_chapter4_Hypothesis_testing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter4/astroml_chapter4_Hypothesis_testing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hypothesis Testing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-classification-and-completeness-vs-contamination-trade-off">Simple classification and completeness vs. contamination trade-off</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Example</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hypothesis-testing">
<h1>Hypothesis Testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this headline">#</a></h1>
<p>In statistics, we often ask whether a given sample agrees with a given model or hypothesis. For example, suppose we have data <span class="math notranslate nohighlight">\(\{x_i\}\)</span> assumed to be drawn from a Gaussian distribution, <span class="math notranslate nohighlight">\(\mathcal{N}(\mu, \sigma)\)</span>. Here, <span class="math notranslate nohighlight">\(\mathcal{N}(\mu,\sigma)\)</span> is our <em>null hypothesis</em>, and we are trying to <em>reject it</em> to show that we measured a particular effect.</p>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<p><strong>Example 1:</strong></p>
<blockquote>
<div><p>After examining a series of astronomical images, there appears to be a faint object that’s reappearing in the same location, but it’s unclear if it’s just noise. To test our hypothesis, we take multiple images of this object over the course of many nights.</p>
<ul class="simple">
<li><p>Here, the <em>null hypothesis</em> is that the measured brightness of this supposed object is due to background noise - if we can reject it, we have a source detection.</p></li>
<li><p>The <em>alternative hypothesis</em> is the rejection of our null hypothesis; that is, that there is genuinely a point source in our image.</p></li>
<li><p>The contribution of the source flux to this object must be substantially larger than the background fluctuation to represent a reliable detection.</p></li>
</ul>
</div></blockquote>
<p>Introducing the <strong>p-value</strong>! The p-value tells you the probability that your data could have occurred, assuming the null hypothesis is correct. It does this by calculating the likelihood of your test statistic, the number calculated by a statistical test using your data. The smaller the p-value, the more likely the alternative hypothesis is correct.</p>
<p>We typically adopt a threshold p-value known as the significance level <span class="math notranslate nohighlight">\(\alpha\)</span>, and we reject the null hypothesis when <span class="math notranslate nohighlight">\(p \leq \alpha\)</span>.</p>
<p><strong>Example 2:</strong></p>
<blockquote>
<div><p>We flip a coin eight times and get six tails; should we reject the hypothesis that the coin is fair? We will assume the null hypothesis that the coin is indeed fair. Recall that we can find probabilities of coin flips with the binomial distribution,</p>
<div class="math notranslate nohighlight">
\[ p(k|b,N) = \frac{N!}{k!(N-k)!} b^k (1-b)^{N-k}. \]</div>
<p>Since p-values are defined as the probability that something <em>at least</em> as extreme as your data could have occurred (assuming the null hypothesis is correct), we can find the p-value by adding the probability of 6/8, 7/8, and 8/8 tails.</p>
<div class="math notranslate nohighlight">
\[ \frac{8!}{6!2!}\frac{1}{2}^6 \frac{1}{2}^2 + \frac{8!}{7!1!}\frac{1}{2}^7 \frac{1}{2}^1 + \frac{8!}{8!0!}\frac{1}{2}^8 \frac{1}{2}^0\]</div>
<p>We get that the probability of this occurring is 0.145; thus, we cannot reject the null hypothesis at the 0.05 significance level.</p>
</div></blockquote>
<p>When performing these tests, we are bound to make two types of errors,</p>
<ul class="simple">
<li><p>Type I: cases when the null hypothesis is true but incorrectly rejected (false positives).</p></li>
<li><p>Type II: Cases when the null hypothesis is false but is accepted (false negative).</p></li>
</ul>
<p>Hypothesis testing is intimately related to comparisons of distributions, discussed further below. Also, be aware that the classical approach to hypothesis testing is not identical to the Bayesian approach.</p>
</section>
<section id="simple-classification-and-completeness-vs-contamination-trade-off">
<h2>Simple classification and completeness vs. contamination trade-off<a class="headerlink" href="#simple-classification-and-completeness-vs-contamination-trade-off" title="Permalink to this headline">#</a></h2>
<p>By decreasing <span class="math notranslate nohighlight">\(\alpha\)</span>, the number of false positives decreases, and the number of false negatives increases. Thus, there is a trade-off when it comes to finding the optimal value of <span class="math notranslate nohighlight">\(\alpha\)</span>, which depends on the particular problem and the relative importance of false negatives and positives.</p>
<section id="example">
<h3>Example:<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>If the null hypothesis is “this airplane is safe to fly,” we would much rather have false positives (the airplane is safe to fly, but we reject it as bad) than false negatives (the airplane is not safe to fly but we accept it as good).</p>
<p>Imagine we are sorting through a pile containing gold and pyrite (a rock similar in appearance to gold but sells for a small fraction of the price, also known as “fool’s gold”). If the null hypothesis is “This piece is real gold,” we would rather have false negatives (accepting a piece of pyrite into the gold pile) than false positives (rejecting a valuable piece of gold).</p>
</div></blockquote>
<p>When we perform multiple cases of hypothesis testing, the fraction of false positives can significantly exceed the value of <span class="math notranslate nohighlight">\(\alpha\)</span>. The fraction of false positives depends not only on <span class="math notranslate nohighlight">\(\alpha\)</span> and the number of data points but also on the number of true positives (the latter is proportional to the number of instances when an alternative hypothesis is true). We shall illustrate these trade-offs with an example.</p>
<p>It’s common that the underlying distribution from which data <span class="math notranslate nohighlight">\(\{x_i\}\)</span> were drawn, <span class="math notranslate nohighlight">\(h(x)\)</span>, is a sum of two populations</p>
<div class="math notranslate nohighlight">
\[ \qquad\qquad\qquad h(x) = (1-a)\: h_B(x)+ah_S(x), \qquad\qquad\qquad (1)\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the relative normalization factor (note that the integrals of <span class="math notranslate nohighlight">\(h_B\)</span> and <span class="math notranslate nohighlight">\(h_S\)</span> are normalized to 1). In this example, there is a null hypothesis (<span class="math notranslate nohighlight">\(B\)</span>, for background) but also a specific alternative hypothesis (<span class="math notranslate nohighlight">\(S\)</span>, for source). Given <span class="math notranslate nohighlight">\(\{x_i\}\)</span>, we want to assign to each individual measurement <span class="math notranslate nohighlight">\(x_i\)</span> the probability that it belongs to population <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(p_S(x_i)\)</span> (note that <span class="math notranslate nohighlight">\(p_B(x_i) = 1 - p_S(x_i)\)</span> as there are only these two possibilities). The size of sample <span class="math notranslate nohighlight">\(\{x_i\}\)</span> is <span class="math notranslate nohighlight">\(N\)</span>, and thus the number of true sources in the sample <span class="math notranslate nohighlight">\(Na\)</span>.</p>
<p>A simplified version of this problem is <strong>classification</strong>, where we assign the class <span class="math notranslate nohighlight">\(S\)</span> or <span class="math notranslate nohighlight">\(B\)</span> without retaining the knowledge of the actual probability <span class="math notranslate nohighlight">\(p_S\)</span>. In order for classification based on <span class="math notranslate nohighlight">\(x\)</span> to be possible at all, <span class="math notranslate nohighlight">\(h_B(x)\)</span> and <span class="math notranslate nohighlight">\(h_S(x\)</span>) must be different.</p>
<p>If we choose a classification boundary value <span class="math notranslate nohighlight">\(x_c\)</span>, then the expected number of false positive sources (Type I errors) in the sample <span class="math notranslate nohighlight">\(Na\)</span> is</p>
<div class="math notranslate nohighlight">
\[ n_\text{ false positive} = N (1-a) \int^\infty_{x_c}h_B(x) dx \equiv N(1-a) \alpha , \]</div>
<p>and the number of false negatives sources, or Type II errors, is</p>
<div class="math notranslate nohighlight">
\[n_\text{ false negative} = Na\int^{x_c}_0 h_s(x)dx \equiv Na\beta. \]</div>
<p>The number of instances when the null hypothesis is rejected (i.e., the number of instances classified as a source) is,</p>
<div class="math notranslate nohighlight">
\[n_\text{ source} = Na-n_\text{ false negative}+n_\text{ false positive}.\]</div>
<p>The sample <strong>completeness</strong> is defined as</p>
<div class="math notranslate nohighlight">
\[ \eta = \frac{Na-n_\text{ false negative}}{Na} = 1 -\int^{x_c}_0 h_S(x)dx, \]</div>
<p>with 0 <span class="math notranslate nohighlight">\( \leq \eta \leq \)</span> 1, and the sample contamination, also known as the <strong>false discovery rate (FDR)</strong>, is defined as</p>
<div class="math notranslate nohighlight">
\[\epsilon = \frac{n_\text{ false positive}}{n_\text{ source}}, \]</div>
<p>with 0 <span class="math notranslate nohighlight">\(\leq \epsilon \leq 1\)</span> (the 1 - <span class="math notranslate nohighlight">\(\epsilon\)</span> rate is sometimes called classification efficiency). Essentially, as <span class="math notranslate nohighlight">\(x_c\)</span> increases, the sample contamination decreases; this is good! However, simultaneously, completeness decreases as well; this is bad. This trade-off can be evaluated using the <strong>receiver operating characteristic (ROC) curve</strong>, a plot of the fraction of true positives vs. the fraction of true negatives. The position along the ROC curve is parametrized by <span class="math notranslate nohighlight">\(x_c\)</span>, and the area under the ROC curve, sometimes called the <span class="math notranslate nohighlight">\(c\)</span> statistic, can be used to quantify the overall performance of the classification method. The question remains: how do we choose an optimal value of <span class="math notranslate nohighlight">\(x_c\)</span>?</p>
</section>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>Assume that <span class="math notranslate nohighlight">\(h_B(x) = \mathcal{N} (\mu = 100, \sigma = 10) \)</span> and <span class="math notranslate nohighlight">\(h_s(x) = \mathcal{N} (\mu = 150, \sigma = 12)\)</span>, with <span class="math notranslate nohighlight">\(a\)</span> = 0.1 and <span class="math notranslate nohighlight">\(N = 10^6\)</span> (this will be image with 1000 x 1000 resolution elements; the <span class="math notranslate nohighlight">\(x\)</span> values correspond to the sum of background and source counts). We will plot these two distributions below.</p>
<p>If we naively choose <span class="math notranslate nohighlight">\(x_c\)</span>=120 (a “<span class="math notranslate nohighlight">\(2\sigma\)</span> cut” away from the mean for <span class="math notranslate nohighlight">\(h_B\)</span>, corresponding to a Type I error probability of <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.024), <strong>21,600 values will be incorrectly classified as a source!</strong> The sample completeness for this value of <span class="math notranslate nohighlight">\(x_c\)</span> is 0.994 and <strong>99,400 values are correctly classified as a source.</strong> Although the Type I error rate is only 0.024, the sample contamination is 21,600/(21,600+99,400) = 0.179, or over 7 times higher!</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># Generate and draw the curves</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">norm</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">norm</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># plot the distributions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#AAAAAA&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;#AAAAAA&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># plot x_c = 120</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.036</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$h_B(x)$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mf">0.0035</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$h_S(x)$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="mf">0.039</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$x_c=120$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$(x &gt; x_c\ {\rm classified\ as\ sources})$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$p(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4cf3f0d072d2283d5e1f202ee1d74e9a3ff423451eaea0c42762c77fdae05dd9.png" src="../_images/4cf3f0d072d2283d5e1f202ee1d74e9a3ff423451eaea0c42762c77fdae05dd9.png" />
</div>
</div>
<p>This result that <span class="math notranslate nohighlight">\(\epsilon \gg \alpha\)</span> is a consequence of the fact that the true population contains nine times as many background values as it contains sources (<span class="math notranslate nohighlight">\(a\)</span>= 0.1).</p>
<p>In order to decrease the expected contamination level <span class="math notranslate nohighlight">\(\epsilon\)</span>, we need to increase <span class="math notranslate nohighlight">\(x_c\)</span>, but the optimal value depends on <span class="math notranslate nohighlight">\(a\)</span>. Since <span class="math notranslate nohighlight">\(a\)</span> is often unknown in practice, choosing <span class="math notranslate nohighlight">\(x_c\)</span> is not straightforward. A simple, practical method for selecting the optimal value of <span class="math notranslate nohighlight">\(x_c\)</span> for a given desired <span class="math notranslate nohighlight">\(\epsilon\)</span> (or FDR) was proposed by Benjamini and Hochberg.</p>
<p>The Benjamini and Hochberg method assumes that measurements can be described by eq. (1) and makes an additional assumption that <span class="math notranslate nohighlight">\(h_B(x)\)</span> is known (e.g., when <span class="math notranslate nohighlight">\(a\)</span> is small, it is possible to isolate a portion of an image to measure background count distribution). Given <span class="math notranslate nohighlight">\(h_B(x)\)</span>, and its cumulative counterpart <span class="math notranslate nohighlight">\(H_B(x)\)</span>, it is possible to assign a <span class="math notranslate nohighlight">\(p\)</span> value to each value in <span class="math notranslate nohighlight">\(\{x_i\}\)</span> as <span class="math notranslate nohighlight">\(p_i = 1 - H_B(x_i)\)</span>, and sort the sample so that <span class="math notranslate nohighlight">\(p_i\)</span> are increasing. If all <span class="math notranslate nohighlight">\(\{x_i\}\)</span> values were drawn from <span class="math notranslate nohighlight">\(h_B(x)\)</span>, the differential distribution of these <span class="math notranslate nohighlight">\(p_i\)</span> values would be a uniform distribution by construction, and its cumulative distribution, <span class="math notranslate nohighlight">\(1 \leq C_i \leq N\)</span>, would increase linearly as</p>
<div class="math notranslate nohighlight">
\[C_i^B = Np_i\]</div>
<p>Instead, for <span class="math notranslate nohighlight">\(Na\)</span> cases in the adopted model the null hypothesis is false and they will result in an excess of small <span class="math notranslate nohighlight">\(p_i\)</span> values; hence, the observed cumulative distribution, <span class="math notranslate nohighlight">\(C_i = C(p_i) = i\)</span>, will have values much larger than <span class="math notranslate nohighlight">\(C_i^B\)</span> for small <span class="math notranslate nohighlight">\(p\)</span>. Benjamini and Hochberg realized that this fact can be used to find a classification threshold <span class="math notranslate nohighlight">\(p_c\)</span> (and the corresponding <span class="math notranslate nohighlight">\(x_c\)</span> and its index <span class="math notranslate nohighlight">\(i_c = C(p_c)\)</span>; recall that the sample is sorted by <span class="math notranslate nohighlight">\(p_i\)</span>) that guarantees that the sample contamination <span class="math notranslate nohighlight">\(\epsilon\)</span> is below some desired value <span class="math notranslate nohighlight">\(\epsilon_0\)</span>. Their proposal for finding <span class="math notranslate nohighlight">\(p_c\)</span> is elegant and does not require involved computations: assume that the null hypothesis is rejected for all values <span class="math notranslate nohighlight">\(p_i \leq p_c\)</span>, resulting in a subsample of <span class="math notranslate nohighlight">\(i_c = C(p_c)\)</span> values (i.e., these <span class="math notranslate nohighlight">\(i_c\)</span> values are selected as sources). The number of cases when the null hypothesis was actually true and falsely rejected is <span class="math notranslate nohighlight">\((1 - a)Np_c &lt; Np_c\)</span>, and thus the contamination rate is</p>
<div class="math notranslate nohighlight">
\[ \epsilon = \frac{(1-a)Np_c}{i_c} &lt; \frac{Np_c}{i_c}\]</div>
<p>Therefore, the threshold value must satisfy</p>
<div class="math notranslate nohighlight">
\[ \qquad\qquad\qquad\qquad i_c &lt; N\frac{p_c}{\epsilon_0} \qquad\qquad\qquad\qquad (2) \]</div>
<p>This condition corresponds to the intersection of the measured <span class="math notranslate nohighlight">\(C_i(p_i)\)</span> curve and the straight line <span class="math notranslate nohighlight">\(C = Np/\epsilon_0\)</span>, and the algorithm is to find the largest value of <span class="math notranslate nohighlight">\(i (= Ci)\)</span> which satisfies the eq. <span class="math notranslate nohighlight">\((2)\)</span>.</p>
<p>Below, we will illustrate the Benjamini and Hochberg method for <span class="math notranslate nohighlight">\(10^6\)</span> points drawn from the distribution shown in our previous figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Set up the background and foreground distributions</span>
<span class="n">background</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">foreground</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Draw from the distribution</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1E6</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">foreground</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span>
<span class="n">X</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">background</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">))</span>

<span class="c1">#------------------------------------------------------------</span>
<span class="c1"># Perform Benjamini-Hochberg method</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">background</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">p_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># plot the results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># only plot every 1000th; plotting all 1E6 takes too long</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_sorted</span><span class="p">[::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_sorted</span><span class="p">[::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">p_sorted</span><span class="p">[::</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;:k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot the cutoffs for various values of expsilon</span>
<span class="n">p_reg_over_eps</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p_reg_over_eps</span> <span class="o">*</span> <span class="n">epsilon</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">p_reg_over_eps</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="sa">r</span><span class="s1">&#39;$\epsilon = </span><span class="si">%.1g</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="n">epsilon</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1E-12</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1E-3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$p = 1 - H_B(i)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;normalized $C(p)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3d8b748cdeabf5b05b4adea565569b8a892288d1054b56f9f6aa2159edc9cd65.png" src="../_images/3d8b748cdeabf5b05b4adea565569b8a892288d1054b56f9f6aa2159edc9cd65.png" />
</div>
</div>
<p>The solid line shows the cumulative distribution of observed p values, normalized by the sample size. The dashed lines show the cutoff for various limits on contamination rate <span class="math notranslate nohighlight">\(\epsilon\)</span> computed using eq. <span class="math notranslate nohighlight">\((2)\)</span> (the accepted measurements are those with p smaller than that corresponding to the intersection of solid and dashed curves). The dotted line shows how the distribution would look in the absence of sources.</p>
<p>Note that <span class="math notranslate nohighlight">\(p_c &lt; \epsilon_0\)</span> because <span class="math notranslate nohighlight">\(i_c &lt; N\)</span>; if one naively adopted <span class="math notranslate nohighlight">\(p_c = \epsilon_0\)</span>, the resulting expected sample contamination would be a factor of <span class="math notranslate nohighlight">\(N/i_c\)</span> larger than <span class="math notranslate nohighlight">\(\epsilon_0\)</span>.
The Benjamini and Hochberg algorithm is conservative because it assumes that <span class="math notranslate nohighlight">\((1 - a) \approx 1\)</span> when deriving the upper bound on <span class="math notranslate nohighlight">\(\epsilon\)</span>. Hence, the resulting contamination rate <span class="math notranslate nohighlight">\(\epsilon\)</span> is a factor of <span class="math notranslate nohighlight">\((1 - a)\)</span> smaller than the maximum allowed value <span class="math notranslate nohighlight">\(\epsilon\)</span>. If we knew <span class="math notranslate nohighlight">\(a\)</span>, we could increase <span class="math notranslate nohighlight">\(i_c\)</span> given by eq. <span class="math notranslate nohighlight">\((2)\)</span> by a factor of <span class="math notranslate nohighlight">\(1/(1 - a)\)</span>, thus increasing the sample completeness while guaranteeing that the sample contamination does not exceed <span class="math notranslate nohighlight">\(\epsilon_0\)</span>.
In cases where one can assume that large values of <span class="math notranslate nohighlight">\(p\)</span> (say, for <span class="math notranslate nohighlight">\(p\)</span> &gt; 0.5) are dominated by the null hypothesis, which is often the case, the cumulative distribution is</p>
<div class="math notranslate nohighlight">
\[C(p_i) = Na+N(1-a)p_i \text{ for } p_i &gt; 0.5\]</div>
<p>with, say, <span class="math notranslate nohighlight">\(C(p_i=0.5) = C_{0.5}\)</span>. Given that the slope of this line is <span class="math notranslate nohighlight">\(2(N − C_{0.5})\)</span>, the number of cases when the null hypothesis is true but falsely rejected can be estimated as <span class="math notranslate nohighlight">\(2(N - C_{0.5})p_c\)</span>. This estimate amounts to scaling <span class="math notranslate nohighlight">\(h_B(x)\)</span> to fit the observed distribution or, equivalently, estimating <span class="math notranslate nohighlight">\((1−a)\)</span> as</p>
<div class="math notranslate nohighlight">
\[ \lambda^{-1} \equiv 1-a = 2\bigg(1-\frac{C_{0.5}}{N}\bigg) \]</div>
<p>Thus, the Benjamini and Hochberg method can be improved by multiplying <span class="math notranslate nohighlight">\(i_c\)</span> by <span class="math notranslate nohighlight">\(\lambda\)</span>, yielding the sample completeness increased by a factor <span class="math notranslate nohighlight">\(\lambda\)</span>. We can look back at the graph above and find that the value of the cumulative distribution at <span class="math notranslate nohighlight">\(p\)</span> = 0.5 is 0.55, which yields a correction factor <span class="math notranslate nohighlight">\(\lambda\)</span> = 1.11.</p>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="astroml_chapter4_Confidence_estimates.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Confidence Estimates: The Bootstrap and The Jackknife</p>
      </div>
    </a>
    <a class="right-next"
       href="astroml_chapter4_Comparison_of_distributions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Comparison of distributions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-classification-and-completeness-vs-contamination-trade-off">Simple classification and completeness vs. contamination trade-off</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Example</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By AstroML developers
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020-2022, AstroML developers.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>